unit AcompanharController;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.Classes, System.Variants,
  FMX.Types, FMX.Graphics, FMX.Controls, FMX.Forms, FMX.Dialogs, FMX.StdCtrls,
  TreinoModel, DataController;

type
  TFrame2 = class(TFrame)
  private
    TSQLManipulador: TFrame1; // A conexão ao banco tá em um form, por que é mais fácil de manipular.
  public
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;

    procedure ExemploSql;
end;


implementation

{$R *.fmx}

constructor TFrame2.Create(AOwner: TComponent);
begin
  inherited;
  TSQLManipulador := TFrame1.Create(Self);
  TSQLManipulador.Visible := False; // Não mostra o form do Sql
end;

destructor TFrame2.Destroy;
begin
  inherited;
end;

procedure TFrame2.ExemploSql;
var
  Treino: TTreino;
begin
  Treino := TTreino.Create;
  try
    TSQLManipulador.TQuerys.SQL.Text := Treino.SqlTodosTreinos;
    TSQLManipulador.TQuerys.Open;

    // Percorrer os resultados
    TSQLManipulador.TQuerys.First;
    while not TSQLManipulador.TQuerys.Eof do
    begin
      // Exemplo: carregar os dados em um objeto
      Treino.FId := TSQLManipulador.TQuerys.FieldByName('id').AsInteger;
      Treino.FNome := TSQLManipulador.TQuerys.FieldByName('nome').AsString;
      Treino.FData := TSQLManipulador.TQuerys.FieldByName('data').AsDateTime;
      Treino.FUsuarioId := TSQLManipulador.TQuerys.FieldByName('usuario_id').AsInteger;

      // Prossiga com o que quiser fazer com o treino carregado

      TSQLManipulador.TQuerys.Next;
    end;

  finally
    Treino.Free;
  end;
end;


end.
